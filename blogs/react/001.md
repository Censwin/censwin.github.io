---
title: 001 生命周期
date: 2021-9-15
categories: 
 - React
tags:
 - React
sidebar: 'auto'
---

 众所周知react16.3及以上版本中废除了原有的`componentWillMount()`、`componentWillUpdate()`以及`componentWillReceiveProps()`三个生命周期函数。取而代之的是`static getDerivedStateFromProps()`以及`getSnapshotBeforeUpdate()`。

被废除的三个生命周期函数均出现在render之前

##  componentWillMount

1. 如果是服务端渲染的话，该函数会被调用两次一次在服务端一次在客户端。
2. 在fiber之后，由于任务中断，willMount可能会被执行多次。
3. 我们应该在didMount中进行数据请求。
4. 如果你想在服务端渲染时先完成数据的展示再一次性给用户，官方的推荐做法是用constructor代替willMount。

误区：

1. willMount中请求数据以优化白屏

   在此生命周期进行请求数据来解决首页白屏问题，但是并没有解决掉，由于JavaScript中异步事件的性质，当您启动API调用时，浏览器会在此期间返回执行其他工作。当React渲染一个组件时，它不会等待`componentWillMount`它完成任何事情 - React继续前进并继续`render`,没有办法“暂停”渲染以等待数据到达。

2. 利用componentWillMount以及componentWillUnmount对称性来进行订阅取消事件

   在开启async rendering，在render函数之前的所有函数，都有可能被执行多次,并且组件的渲染也很有可能会被其他的事务所打断，导致`componentWillUnmount`不会被调用。而`componentDidMount`就不存在这个问题，在`componentDidMount`被调用后，`componentWillUnmount`一定会随后被调用到。

## componentWillReceiveProps



---

参考文献：

[rfrc](https://github.com/reactjs/rfcs/blob/main/text/0006-static-lifecycle-methods.md)

https://blog.csdn.net/y523006369/article/details/103630145?utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1.no_search_link&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1.no_search_link

https://segmentfault.com/a/1190000021272657

https://juejin.cn/post/6844903782044663816

https://zhuanlan.zhihu.com/p/65124686

https://segmentfault.com/q/1010000008133309