(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{574:function(t,s,a){"use strict";a.r(s);var n=a(13),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),a("p",[t._v("在我们实际开发过程中，时常会遇到层级问题，但是当使用 "),a("code",[t._v("z-index")]),t._v(" 时效果又不如预期，本质上还是对 层叠上下文 的了解不够深入导致，以下将从几个角度重新理解层叠上下文")]),t._v(" "),a("h2",{attrs:{id:"层叠上下文"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#层叠上下文"}},[t._v("#")]),t._v(" 层叠上下文")]),t._v(" "),a("p",[t._v("层叠上下文(stacking context)，是HTML中一个三维的概念。简单的说层叠上下文类似于 Photoshop 中的 "),a("strong",[t._v("组")]),t._v("，而元素则对应组中的"),a("strong",[t._v("图层")]),t._v("以此来体现层叠关系。")]),t._v(" "),a("p",[a("img",{attrs:{src:t.$withBase("/css/04/04-1.jpg")}})]),t._v(" "),a("h2",{attrs:{id:"层叠等级"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#层叠等级"}},[t._v("#")]),t._v(" 层叠等级")]),t._v(" "),a("ul",[a("li",[t._v("在层叠上下文中，表示的是层叠上下文元素在"),a("code",[t._v("Z轴")]),t._v("上的堆叠顺序")]),t._v(" "),a("li",[t._v("在其他元素中，表示普通元素在"),a("code",[t._v("Z轴")]),t._v("上的堆叠顺序")])]),t._v(" "),a("p",[t._v("那么这里就产生了一个疑惑，那么既然层叠等级指层叠顺序，那为什么z-index的设置会不如预期，如图"),a("code",[t._v(".tooltip")]),t._v("  的 "),a("code",[t._v("z-index")]),t._v(" 显然大于 "),a("code",[t._v("header")]),t._v("，但结果不如预期")]),t._v(" "),a("p",[a("img",{attrs:{src:t.$withBase("/css/04/04-2.jpg")}})]),t._v(" "),a("h3",{attrs:{id:"为什么"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为什么"}},[t._v("#")]),t._v(" 为什么")]),t._v(" "),a("p",[t._v("因为"),a("strong",[t._v("层叠等级的比较")]),t._v("需要在"),a("strong",[t._v("相同")]),t._v("的层叠上下文中比较才有意义，不同层叠上下文中比较层叠等级是没有意义的，同理与 Photoshop 相同的组别内的图层堆叠等级比较才有意义，那么我们将上图的结构进行解析可以得到：")]),t._v(" "),a("p",[a("img",{attrs:{src:t.$withBase("/css/04/04-3.jpg")}})]),t._v(" "),a("p",[t._v("可以很明显的看出"),a("code",[t._v(".tooltip")]),t._v(" 的 9999 仅仅是在 "),a("code",[t._v("main")]),t._v(" 这个层叠上下文中进行比较")]),t._v(" "),a("h3",{attrs:{id:"修复示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修复示例"}},[t._v("#")]),t._v(" 修复示例")]),t._v(" "),a("p",[t._v("我们仅仅需要将 "),a("code",[t._v(".main")]),t._v(" 中的 "),a("code",[t._v("z-index")]),t._v(" 去掉即可")]),t._v(" "),a("p",[a("img",{attrs:{src:t.$withBase("/css/04/04-4.jpg")}})]),t._v(" "),a("p",[t._v("去掉之后我们的层叠上下文如下所示")]),t._v(" "),a("p",[a("img",{attrs:{src:t.$withBase("/css/04/04-5.jpg")}})]),t._v(" "),a("p",[t._v("我们的"),a("code",[t._v("tooltip")]),t._v(" 与 "),a("code",[t._v("header")]),t._v("处在了同一上下文中进行比较，那么为什么去掉 "),a("code",[t._v("main")]),t._v(" 的 "),a("code",[t._v("z-index")]),t._v(" 之后他的层叠上下文就消失了呢？这要涉及到层叠上下文的创建规则")]),t._v(" "),a("h3",{attrs:{id:"创建层叠上下文"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建层叠上下文"}},[t._v("#")]),t._v(" 创建层叠上下文")]),t._v(" "),a("ol",[a("li",[a("p",[a("code",[t._v("HTML")]),t._v("中的根元素"),a("code",[t._v("<html></html>")]),t._v("本身j就具有层叠上下文，称为“根层叠上下文”")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("position")]),t._v(" 属性为 "),a("code",[t._v("relative")]),t._v(" 或 "),a("code",[t._v("absolute")]),t._v("（"),a("strong",[t._v("并设置"),a("code",[t._v("z-index")]),t._v("属性")]),t._v("）")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("position")]),t._v(" 属性为 "),a("code",[t._v("fixed")]),t._v(" 或 "),a("code",[t._v("sticky")]),t._v(" （无需 z-index 直接产生上下文）")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("opacity")]),t._v(" 小于 "),a("code",[t._v("1")])])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/CSS/mix-blend-mode",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("mix-blend-mode")]),a("OutboundLink")],1),t._v(" 不为 "),a("code",[t._v("normal")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("display: flex")]),t._v(" 或 "),a("code",[t._v("display: grid")]),t._v(" （"),a("strong",[t._v("并给子元素设置"),a("code",[t._v("z-index")]),t._v("属性")]),t._v("）")])]),t._v(" "),a("li",[a("p",[t._v("使用"),a("code",[t._v("transform")]),t._v(", "),a("code",[t._v("filter")]),t._v(", "),a("code",[t._v("clip-path")]),t._v(", 或"),a("code",[t._v("perspective")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("will-change")]),t._v(" 值为 "),a("code",[t._v("opacity")]),t._v(" 或 "),a("code",[t._v("transform")])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("显性地创建")]),t._v("层叠上下文 "),a("code",[t._v("isolation: isolate")])]),t._v(" "),a("p",[t._v("完整列表："),a("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Positioning/Understanding_z_index/The_stacking_context#the_stacking_context",target:"_blank",rel:"noopener noreferrer"}},[t._v("MDN"),a("OutboundLink")],1)]),t._v(" "),a("h4",{attrs:{id:"常见误解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见误解"}},[t._v("#")]),t._v(" 常见误解")]),t._v(" "),a("p",[a("img",{attrs:{src:t.$withBase("/css/04/04-6.jpg")}})]),t._v(" "),a("p",[t._v("第二个盒子显然通过"),a("code",[t._v("z-index")]),t._v("堆叠与其他兄弟节点之前，但是却没有设置 "),a("code",[t._v("position")]),t._v(" 相关属性，这是由于在 Flexbox 规则中添加了一个例外： flex 子元素即使 "),a("code",[t._v("position")]),t._v(" 为 "),a("code",[t._v("static")]),t._v(" 依然可以使用 "),a("code",[t._v("z-index")])]),t._v(" "),a("p",[t._v("因此说所有元素都可以使用 "),a("code",[t._v("z-index")]),t._v(" 是一个误区，Flexbox 是一个特例")])])]),t._v(" "),a("h3",{attrs:{id:"稍等一下"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#稍等一下"}},[t._v("#")]),t._v(" 稍等一下......")]),t._v(" "),a("p",[t._v("这里有一些奇怪的事情值得我们思考一两分钟")]),t._v(" "),a("p",[t._v("在 Photoshop 中，"),a("code",[t._v("组")]),t._v("与"),a("code",[t._v("层")]),t._v("之间是有明显差异的，可视元素为"),a("code",[t._v("层")]),t._v("，而"),a("code",[t._v("组")]),t._v("则在结构上包裹"),a("code",[t._v("层")]),t._v("，这是一种很清晰的概念；但在web中，这种差异就显得模糊了，任何想要使用"),a("code",[t._v("z-index")]),t._v("的元素都需要创建层叠上下文；")]),t._v(" "),a("p",[t._v("而当我们决定给元素添加一个"),a("code",[t._v("z-index")]),t._v("时，我们的目的又变成在 "),a("strong",[t._v("该元素的父级层叠上下文中")]),t._v("降低或提升该元素的层叠等级。")]),t._v(" "),a("p",[t._v("当我们为此创建层叠上下文时，那么该元素就变成了一个组，原先该组的子元素层叠等级被扁平化包裹在组内，"),a("em",[t._v("同时也将子元素牢牢锁在这个组中")])]),t._v(" "),a("p",[t._v("我们重新看回示例代码：")]),t._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("header")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  不你不能\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("header")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("tooltip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    我想站前面\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Some main content"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("p",[t._v("在默认情况下，HTML 元素会根据DOM的顺序进行堆叠，也就是说我们并不需要任何的 CSS 介入也可以让 "),a("code",[t._v("main")]),t._v(" 现实在 "),a("code",[t._v("header")]),t._v(" 之前，我们随后通过"),a("code",[t._v("z-index")]),t._v("改变了"),a("code",[t._v("header")]),t._v("的堆叠顺序，但于此同时"),a("code",[t._v("header")]),t._v("的子元素也全部被扁平化。")]),t._v(" "),a("p",[t._v("我们不能单纯的将"),a("code",[t._v("z-index")]),t._v("理解为改变层叠顺序的一种方式，"),a("strong",[t._v("同时也应该将"),a("code",[t._v("z-index")]),t._v("理解为将其子元素组成小组的一种方式")])]),t._v(" "),a("blockquote",[a("p",[t._v("那或许你会说为什么不能讲z-index进行全局比较模糊组的概念，试想一下如果开发过程中每个元素都要全局比较那10000个元素又怎么比较？")]),t._v(" "),a("p",[t._v("同时也能利用这一特性来“封闭”元素，对于像 "),a("code",[t._v("React")]),t._v(" 这种组件驱动的框架及其有用")])]),t._v(" "),a("h3",{attrs:{id:"isolation-抽象概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#isolation-抽象概念"}},[t._v("#")]),t._v(" "),a("code",[t._v("isolation")]),t._v(" 抽象概念")]),t._v(" "),a("p",[t._v("这是一个非常有用的 CSS 属性，同时也是最令人感到疑惑的属性质疑，这或许是一个 “宝藏”属性")]),t._v(" "),a("p",[t._v("如何使用：")]),t._v(" "),a("div",{staticClass:"language-css line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-css"}},[a("code",[a("span",{pre:!0,attrs:{class:"token selector"}},[t._v(".wrapper")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("isolation")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" isolate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("当使用这个属性时，他只做一件事情：创建一个层叠上下文")]),t._v(" "),a("p",[t._v("那么已经有了上述这么多创建层叠上下文的方法，为什么我们又需要这一个呢？")]),t._v(" "),a("p",[t._v("反观其他创建方式，你会发现他们都是通过一些其他修改来隐式创建的，而 "),a("code",[t._v("isolation")]),t._v(" 则是显性创建：")]),t._v(" "),a("ul",[a("li",[t._v("不需要规定 "),a("code",[t._v("z-index")]),t._v(" 的值")]),t._v(" "),a("li",[t._v("可以作用到 "),a("code",[t._v("static")]),t._v(" 元素")]),t._v(" "),a("li",[t._v("不会影响到子元素")])]),t._v(" "),a("h4",{attrs:{id:"示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[t._v("#")]),t._v(" 示例")]),t._v(" "),a("p",[t._v("有这样一个需求：当鼠标移入展开信封")]),t._v(" "),a("p",[a("img",{attrs:{src:t.$withBase("/css/04/04-7.gif")}})]),t._v(" "),a("p",[t._v("结构如下：")]),t._v(" "),a("p",[a("img",{attrs:{src:t.$withBase("/css/04/04-8.jpg")}})]),t._v(" "),a("p",[t._v("示例代码如下：")]),t._v(" "),a("div",{staticClass:"language-jsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Envelope")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" children "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n      ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BackPane")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("style")]),a("span",{pre:!0,attrs:{class:"token script language-javascript"}},[a("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("zIndex")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n      ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Letter")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("style")]),a("span",{pre:!0,attrs:{class:"token script language-javascript"}},[a("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("zIndex")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n        ")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n      ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Letter")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n      ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Shell")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("style")]),a("span",{pre:!0,attrs:{class:"token script language-javascript"}},[a("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("zIndex")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n      ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Flap")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("style")]),a("span",{pre:!0,attrs:{class:"token script language-javascript"}},[a("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("zIndex")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" isOpen "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n    ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br")])]),a("p",[t._v("乍一看似乎没有问题，但当我们添加一个"),a("code",[t._v("header")]),t._v("并设置"),a("code",[t._v("z-index:3")]),t._v("，问题出现了，虽然四个组件包裹在一个div中但并没有创建层叠上下文，导致"),a("code",[t._v("z-index")]),t._v("开始于外部进行比较，这些层开始交织在一起")]),t._v(" "),a("p",[a("img",{attrs:{src:t.$withBase("/css/04/04-9.gif")}})]),t._v(" "),a("p",[t._v("我们通过使用 "),a("code",[t._v("isolation: isolate")]),t._v(" 进行隔离，确保该组件为一组：")]),t._v(" "),a("div",{staticClass:"language-jsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Envelope")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" children "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("style")]),a("span",{pre:!0,attrs:{class:"token script language-javascript"}},[a("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("isolation")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'isolate'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n      ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BackPane")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("style")]),a("span",{pre:!0,attrs:{class:"token script language-javascript"}},[a("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("zIndex")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n      ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Letter")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("style")]),a("span",{pre:!0,attrs:{class:"token script language-javascript"}},[a("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("zIndex")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n        ")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n      ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Letter")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n      ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Shell")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("style")]),a("span",{pre:!0,attrs:{class:"token script language-javascript"}},[a("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("zIndex")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n      ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Flap")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("style")]),a("span",{pre:!0,attrs:{class:"token script language-javascript"}},[a("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("zIndex")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" isOpen "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n    ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br")])]),a("p",[t._v("那么为什么不使用 "),a("code",[t._v("position: relative; z-index: 1")]),t._v(" 来解决这个问题？因为 React 组件意味着可复用性，那么 这里的 "),a("code",[t._v("z-index: 1")]),t._v(" 永远正确并且适用于其他页面吗？显然不是，这种"),a("code",[t._v("隔离")]),t._v("的概念巧妙地增加了组件的灵活性。")]),t._v(" "),a("h3",{attrs:{id:"开发调试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开发调试"}},[t._v("#")]),t._v(" 开发调试")]),t._v(" "),a("p",[t._v("目前在 Microsoft Edge 已经实现了 3D 视图功能，这个功能对层叠上下文调试非常有用")]),t._v(" "),a("p",[a("img",{attrs:{src:t.$withBase("/css/04/04-10.jpg")}})]),t._v(" "),a("p",[a("strong",[t._v("注意")])]),t._v(" "),a("p",[t._v("Chrome 中的 layer 看起来很类似，但其实不然，图层跟层叠上下文不是一个概念，一个图层可以包含多个层叠上下文，这里的图层指的是 "),a("code",[t._v("图形层")]),t._v(",要讲图形层又涉及到 "),a("code",[t._v("渲染层")]),t._v("和"),a("code",[t._v("合成层")]),t._v(",感兴趣可以"),a("a",{attrs:{href:"https://segmentfault.com/a/1190000014520786",target:"_blank",rel:"noopener noreferrer"}},[t._v("看这里"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("strong",[t._v("插件")])]),t._v(" "),a("ol",[a("li",[a("p",[t._v("在 Chrome 中调试可以使用插件 "),a("a",{attrs:{href:"https://chrome.google.com/webstore/detail/css-stacking-context-insp/apjeljpachdcjkgnamgppgfkmddadcki",target:"_blank",rel:"noopener noreferrer"}},[t._v("CSS Stacking Context inspector"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("img",{attrs:{src:t.$withBase("/css/04/04-11.jpg")}})])]),t._v(" "),a("li",[a("p",[t._v("通过VS code 插件在开发过程中及时发现问题 ："),a("a",{attrs:{href:"https://marketplace.visualstudio.com/items?itemName=felixfbecker.css-stacking-contexts",target:"_blank",rel:"noopener noreferrer"}},[t._v("VSCode extension that highlights when stacking contexts are created"),a("OutboundLink")],1)])])]),t._v(" "),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),a("ol",[a("li",[t._v("https://www.joshwcomeau.com/css/04/stacking-contexts/")])])])}),[],!1,null,null,null);s.default=e.exports}}]);